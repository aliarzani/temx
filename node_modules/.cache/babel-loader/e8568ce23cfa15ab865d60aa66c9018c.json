{"ast":null,"code":"import _regeneratorRuntime from \"/workspaces/temx/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/workspaces/temx/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport axios from 'axios';\nimport { applogicUrl, arkeUrl, authUrl, tradeUrl, withCredentials } from './config';\n\nvar getAPI = function getAPI() {\n  return {\n    barong: \"\".concat(authUrl()),\n    applogic: \"\".concat(applogicUrl()),\n    peatio: \"\".concat(tradeUrl()),\n    arke: \"\".concat(arkeUrl())\n  };\n};\n\nvar buildRequest = function buildRequest(request, configData) {\n  var body = request.body,\n      method = request.method,\n      url = request.url;\n  var apiVersion = configData.apiVersion;\n  var api = getAPI();\n  var contentType = body instanceof FormData ? 'multipart/form-data' : 'application/json';\n  var headers = {\n    'content-type': contentType\n  };\n  var apiUrl = api[apiVersion];\n  var requestConfig = {\n    baseURL: apiUrl,\n    data: body,\n    headers: headers,\n    method: method,\n    url: url,\n    withCredentials: withCredentials()\n  };\n  return requestConfig;\n};\n\nexport var defaultResponse = {\n  status: 500,\n  data: {\n    error: 'Server error'\n  }\n};\nexport var formatError = function formatError(responseError) {\n  var response = responseError.response || defaultResponse;\n  var errors = response.data && (response.data.errors || [response.data.error]) || [];\n  return {\n    code: response.status,\n    message: errors\n  };\n};\nexport var makeRequest =\n/*#__PURE__*/\nfunction () {\n  var _ref = _asyncToGenerator(\n  /*#__PURE__*/\n  _regeneratorRuntime.mark(function _callee(request, configData) {\n    var requestConfig;\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            requestConfig = buildRequest(request, configData);\n            return _context.abrupt(\"return\", new Promise(function (resolve, reject) {\n              var axiosRequest = axios(requestConfig);\n              axiosRequest.then(function (response) {\n                if (configData.withHeaders) {\n                  resolve(response);\n                } else {\n                  resolve(response.data);\n                }\n              }).catch(function (error) {\n                reject(formatError(error));\n              });\n            }));\n\n          case 2:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee);\n  }));\n\n  return function makeRequest(_x, _x2) {\n    return _ref.apply(this, arguments);\n  };\n}();","map":{"version":3,"sources":["/workspaces/temx/src/api/requestBuilder.ts"],"names":["axios","applogicUrl","arkeUrl","authUrl","tradeUrl","withCredentials","getAPI","barong","applogic","peatio","arke","buildRequest","request","configData","body","method","url","apiVersion","api","contentType","FormData","headers","apiUrl","requestConfig","baseURL","data","defaultResponse","status","error","formatError","responseError","response","errors","code","message","makeRequest","Promise","resolve","reject","axiosRequest","then","withHeaders","catch"],"mappings":"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","sourcesContent":["import axios, {\n    AxiosError,\n    AxiosPromise,\n    AxiosRequestConfig,\n    AxiosResponse,\n} from 'axios';\nimport {\n    applogicUrl,\n    arkeUrl,\n    authUrl,\n    tradeUrl,\n    withCredentials,\n} from './config';\n\nexport type HTTPMethod =\n    'get'\n    | 'post'\n    | 'delete'\n    | 'put'\n    | 'patch';\n\nexport interface JsonBody {\n    // tslint:disable-next-line no-any\n    [key: string]: any;\n}\n\nexport interface RequestOptions {\n    apiVersion: 'applogic' | 'peatio' | 'barong' | 'arke';\n    withHeaders?: boolean;\n}\n\nexport interface Request {\n    method: HTTPMethod;\n    url: string;\n    body?: JsonBody;\n}\n\nexport interface ApiVariety {\n    barong: string;\n    applogic: string;\n    peatio: string;\n}\n\nconst getAPI = () => ({\n    barong: `${authUrl()}`,\n    applogic: `${applogicUrl()}`,\n    peatio: `${tradeUrl()}`,\n    arke: `${arkeUrl()}`,\n});\n\nconst buildRequest = (request: Request, configData: RequestOptions) => {\n    const { body, method, url } = request;\n    const { apiVersion } = configData;\n    const api = getAPI();\n\n    const contentType = body instanceof FormData\n        ? 'multipart/form-data'\n        : 'application/json';\n\n    const headers = {\n        'content-type': contentType,\n    };\n\n    const apiUrl = api[apiVersion];\n\n    const requestConfig: AxiosRequestConfig = {\n        baseURL: apiUrl,\n        data: body,\n        headers,\n        method,\n        url,\n        withCredentials: withCredentials(),\n    };\n\n    return requestConfig;\n};\n\nexport const defaultResponse: Partial<AxiosError['response']> = {\n    status: 500,\n    data: {\n        error: 'Server error',\n    },\n};\n\nexport const formatError = (responseError: AxiosError) => {\n    const response = responseError.response || defaultResponse;\n    const errors = (response.data && (response.data.errors || [response.data.error])) || [];\n    return {\n        code: response.status,\n        message: errors,\n    };\n};\n\nexport const makeRequest = async (request: Request, configData: RequestOptions) => {\n    const requestConfig = buildRequest(request, configData);\n\n    return new Promise((resolve, reject) => {\n        const axiosRequest: AxiosPromise = axios(requestConfig);\n        axiosRequest\n            .then((response: AxiosResponse) => {\n                if (configData.withHeaders) {\n                    resolve(response);\n                } else {\n                    resolve(response.data);\n                }\n            })\n            .catch((error: AxiosError) => {\n                reject(formatError(error));\n            });\n    });\n};\n"]},"metadata":{},"sourceType":"module"}