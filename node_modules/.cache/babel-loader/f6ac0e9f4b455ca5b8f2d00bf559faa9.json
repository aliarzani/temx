{"ast":null,"code":"import _toConsumableArray from \"/workspaces/temx/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _defineProperty from \"/workspaces/temx/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport { defaultStorageLimit } from '../../../api';\nimport { RECENT_TRADES_DATA, RECENT_TRADES_ERROR, RECENT_TRADES_FETCH, RECENT_TRADES_PUSH } from './constants';\nvar initialState = {\n  list: [],\n  loading: false\n};\nexport var convertTradeEventToTrade = function convertTradeEventToTrade(market, trade) {\n  return {\n    market: market,\n    id: trade.tid,\n    created_at: new Date(trade.date * 1000).toISOString(),\n    taker_type: trade.taker_type,\n    price: String(trade.price),\n    amount: String(trade.amount),\n    total: String(trade.total)\n  };\n};\nexport var convertTradeEventList = function convertTradeEventList(market, trades) {\n  return trades.map(function (trade) {\n    return convertTradeEventToTrade(market, trade);\n  });\n};\nexport var recentTradesReducer = function recentTradesReducer() {\n  var state = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : initialState;\n  var action = arguments.length > 1 ? arguments[1] : undefined;\n\n  switch (action.type) {\n    case RECENT_TRADES_DATA:\n      {\n        return {\n          list: action.payload.slice(0, defaultStorageLimit()),\n          loading: false\n        };\n      }\n\n    case RECENT_TRADES_ERROR:\n      {\n        return {\n          list: [],\n          loading: false,\n          error: action.payload\n        };\n      }\n\n    case RECENT_TRADES_FETCH:\n      {\n        return _objectSpread({}, state, {\n          loading: true\n        });\n      }\n\n    case RECENT_TRADES_PUSH:\n      {\n        var lastTrades = convertTradeEventList(action.payload.market, action.payload.trades);\n        return _objectSpread({}, state, {\n          list: [].concat(_toConsumableArray(lastTrades), _toConsumableArray(state.list)).slice(0, defaultStorageLimit())\n        });\n      }\n\n    default:\n      return state;\n  }\n};","map":{"version":3,"sources":["/workspaces/temx/src/modules/public/recentTrades/reducer.ts"],"names":["defaultStorageLimit","RECENT_TRADES_DATA","RECENT_TRADES_ERROR","RECENT_TRADES_FETCH","RECENT_TRADES_PUSH","initialState","list","loading","convertTradeEventToTrade","market","trade","id","tid","created_at","Date","date","toISOString","taker_type","price","String","amount","total","convertTradeEventList","trades","map","recentTradesReducer","state","action","type","payload","slice","error","lastTrades"],"mappings":";;;;;;;AAAA,SAASA,mBAAT,QAAoC,cAApC;AAIA,SACIC,kBADJ,EAEIC,mBAFJ,EAGIC,mBAHJ,EAIIC,kBAJJ,QAKO,aALP;AAcA,IAAMC,YAA+B,GAAG;AACpCC,EAAAA,IAAI,EAAE,EAD8B;AAEpCC,EAAAA,OAAO,EAAE;AAF2B,CAAxC;AAKA,OAAO,IAAMC,wBAAwB,GAAG,SAA3BA,wBAA2B,CAACC,MAAD,EAAiBC,KAAjB;AAAA,SAA2D;AAC/FD,IAAAA,MAAM,EAANA,MAD+F;AAE/FE,IAAAA,EAAE,EAAED,KAAK,CAACE,GAFqF;AAG/FC,IAAAA,UAAU,EAAE,IAAIC,IAAJ,CAASJ,KAAK,CAACK,IAAN,GAAa,IAAtB,EAA4BC,WAA5B,EAHmF;AAI/FC,IAAAA,UAAU,EAAEP,KAAK,CAACO,UAJ6E;AAK/FC,IAAAA,KAAK,EAAEC,MAAM,CAACT,KAAK,CAACQ,KAAP,CALkF;AAM/FE,IAAAA,MAAM,EAAED,MAAM,CAACT,KAAK,CAACU,MAAP,CANiF;AAO/FC,IAAAA,KAAK,EAAEF,MAAM,CAACT,KAAK,CAACW,KAAP;AAPkF,GAA3D;AAAA,CAAjC;AAUP,OAAO,IAAMC,qBAAqB,GAAG,SAAxBA,qBAAwB,CAACb,MAAD,EAAiBc,MAAjB;AAAA,SACjCA,MAAM,CAACC,GAAP,CAAW,UAAAd,KAAK;AAAA,WAAIF,wBAAwB,CAACC,MAAD,EAASC,KAAT,CAA5B;AAAA,GAAhB,CADiC;AAAA,CAA9B;AAIP,OAAO,IAAMe,mBAAmB,GAAG,SAAtBA,mBAAsB,GAAuD;AAAA,MAAtDC,KAAsD,uEAA9CrB,YAA8C;AAAA,MAAhCsB,MAAgC;;AACtF,UAAQA,MAAM,CAACC,IAAf;AACI,SAAK3B,kBAAL;AAAyB;AACrB,eAAO;AACHK,UAAAA,IAAI,EAAEqB,MAAM,CAACE,OAAP,CAAeC,KAAf,CAAqB,CAArB,EAAwB9B,mBAAmB,EAA3C,CADH;AAEHO,UAAAA,OAAO,EAAE;AAFN,SAAP;AAIH;;AACD,SAAKL,mBAAL;AAA0B;AACtB,eAAO;AACHI,UAAAA,IAAI,EAAE,EADH;AAEHC,UAAAA,OAAO,EAAE,KAFN;AAGHwB,UAAAA,KAAK,EAAEJ,MAAM,CAACE;AAHX,SAAP;AAKH;;AACD,SAAK1B,mBAAL;AAA0B;AACtB,iCACOuB,KADP;AAEInB,UAAAA,OAAO,EAAE;AAFb;AAIH;;AACD,SAAKH,kBAAL;AAAyB;AACrB,YAAM4B,UAAU,GAAGV,qBAAqB,CAACK,MAAM,CAACE,OAAP,CAAepB,MAAhB,EAAwBkB,MAAM,CAACE,OAAP,CAAeN,MAAvC,CAAxC;AACA,iCACOG,KADP;AAEIpB,UAAAA,IAAI,EAAE,6BACC0B,UADD,sBAECN,KAAK,CAACpB,IAFP,GAGJwB,KAHI,CAGE,CAHF,EAGK9B,mBAAmB,EAHxB;AAFV;AAOH;;AACD;AACI,aAAO0B,KAAP;AA/BR;AAiCH,CAlCM","sourcesContent":["import { defaultStorageLimit } from '../../../api';\nimport { CommonError } from '../../types';\nimport { PublicTrade } from '../../user/history';\nimport { RecentTradesActions } from './actions';\nimport {\n    RECENT_TRADES_DATA,\n    RECENT_TRADES_ERROR,\n    RECENT_TRADES_FETCH,\n    RECENT_TRADES_PUSH,\n} from './constants';\nimport { PublicTradeEvent } from './types';\n\nexport interface RecentTradesState {\n    list: PublicTrade[];\n    loading: boolean;\n    error?: CommonError;\n}\n\nconst initialState: RecentTradesState = {\n    list: [],\n    loading: false,\n};\n\nexport const convertTradeEventToTrade = (market: string, trade: PublicTradeEvent): PublicTrade => ({\n    market,\n    id: trade.tid,\n    created_at: new Date(trade.date * 1000).toISOString(),\n    taker_type: trade.taker_type,\n    price: String(trade.price),\n    amount: String(trade.amount),\n    total: String(trade.total),\n});\n\nexport const convertTradeEventList = (market: string, trades: PublicTradeEvent[]): PublicTrade[] =>\n    trades.map(trade => convertTradeEventToTrade(market, trade));\n\n\nexport const recentTradesReducer = (state = initialState, action: RecentTradesActions) => {\n    switch (action.type) {\n        case RECENT_TRADES_DATA: {\n            return {\n                list: action.payload.slice(0, defaultStorageLimit()),\n                loading: false,\n            };\n        }\n        case RECENT_TRADES_ERROR: {\n            return {\n                list: [],\n                loading: false,\n                error: action.payload,\n            };\n        }\n        case RECENT_TRADES_FETCH: {\n            return {\n                ...state,\n                loading: true,\n            };\n        }\n        case RECENT_TRADES_PUSH: {\n            const lastTrades = convertTradeEventList(action.payload.market, action.payload.trades);\n            return {\n                ...state,\n                list: [\n                    ...lastTrades,\n                    ...state.list,\n                ].slice(0, defaultStorageLimit()),\n            };\n        }\n        default:\n            return state;\n    }\n};\n"]},"metadata":{},"sourceType":"module"}