{"ast":null,"code":"import _classCallCheck from \"/workspaces/temx/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/workspaces/temx/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/workspaces/temx/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/workspaces/temx/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/workspaces/temx/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/workspaces/temx/src/containers/RecentTrades/Market.tsx\";\nimport { Decimal, Table } from '@openware/components';\nimport * as React from 'react';\nimport { injectIntl } from 'react-intl';\nimport { connect } from 'react-redux';\nimport { localeDate, setTradeColor } from '../../helpers';\nimport { selectCurrentMarket, selectCurrentPrice, setCurrentPrice as _setCurrentPrice } from '../../modules';\nimport { recentTradesFetch, selectRecentTradesOfCurrentMarket } from '../../modules/public/recentTrades';\n\nvar handleHighlightValue = function handleHighlightValue(prevValue, curValue) {\n  var highlighted = '';\n  var val = curValue;\n  var prev = prevValue;\n\n  while (val !== prev && val.length > 0) {\n    highlighted = val[val.length - 1] + highlighted;\n    val = val.slice(0, -1);\n    prev = prev.slice(0, -1);\n  }\n\n  return React.createElement(React.Fragment, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 44\n    },\n    __self: this\n  }, React.createElement(\"span\", {\n    className: \"cr-decimal__opacity\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 45\n    },\n    __self: this\n  }, val), React.createElement(\"span\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 46\n    },\n    __self: this\n  }, highlighted));\n};\n\nvar MarketComponent =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(MarketComponent, _React$Component);\n\n  function MarketComponent() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, MarketComponent);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(MarketComponent)).call.apply(_getPrototypeOf2, [this].concat(args)));\n\n    _this.getHeaders = function () {\n      return [_this.props.intl.formatMessage({\n        id: 'page.body.trade.header.recentTrades.content.time'\n      }), _this.props.intl.formatMessage({\n        id: 'page.body.trade.header.recentTrades.content.amount'\n      }), _this.props.intl.formatMessage({\n        id: 'page.body.trade.header.recentTrades.content.price'\n      })];\n    };\n\n    _this.handleOnSelect = function (index) {\n      var _this$props = _this.props,\n          recentTrades = _this$props.recentTrades,\n          currentPrice = _this$props.currentPrice;\n      var priceToSet = recentTrades[Number(index)] ? recentTrades[Number(index)].price : '';\n\n      if (currentPrice !== priceToSet) {\n        _this.props.setCurrentPrice(priceToSet);\n      }\n    };\n\n    return _this;\n  }\n\n  _createClass(MarketComponent, [{\n    key: \"componentWillReceiveProps\",\n    value: function componentWillReceiveProps(next) {\n      if (next.currentMarket && this.props.currentMarket !== next.currentMarket) {\n        this.props.tradesFetch(next.currentMarket);\n      }\n    }\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      if (this.props.currentMarket) {\n        this.props.tradesFetch(this.props.currentMarket);\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      return React.createElement(\"div\", {\n        className: \"pg-recent-trades__markets\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 67\n        },\n        __self: this\n      }, React.createElement(Table, {\n        data: this.getTrades(this.props.recentTrades),\n        header: this.getHeaders(),\n        onSelect: this.handleOnSelect,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 68\n        },\n        __self: this\n      }));\n    }\n  }, {\n    key: \"getTrades\",\n    value: function getTrades(trades) {\n      var priceFixed = this.props.currentMarket ? this.props.currentMarket.price_precision : 0;\n      var amountFixed = this.props.currentMarket ? this.props.currentMarket.amount_precision : 0;\n\n      var renderRow = function renderRow(item, i) {\n        var created_at = item.created_at,\n            taker_type = item.taker_type,\n            price = item.price,\n            amount = item.amount;\n        var higlightedDate = handleHighlightValue(String(localeDate(trades[i - 1] ? trades[i - 1].created_at : '', 'time')), String(localeDate(created_at, 'time')));\n        return [React.createElement(\"span\", {\n          style: {\n            color: setTradeColor(taker_type).color\n          },\n          key: i,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 94\n          },\n          __self: this\n        }, higlightedDate), React.createElement(\"span\", {\n          style: {\n            color: setTradeColor(taker_type).color\n          },\n          key: i,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 95\n          },\n          __self: this\n        }, React.createElement(Decimal, {\n          fixed: amountFixed,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 95\n          },\n          __self: this\n        }, amount)), React.createElement(\"span\", {\n          style: {\n            color: setTradeColor(taker_type).color\n          },\n          key: i,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 96\n          },\n          __self: this\n        }, React.createElement(Decimal, {\n          fixed: priceFixed,\n          prevValue: trades[i - 1] ? trades[i - 1].price : 0,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 96\n          },\n          __self: this\n        }, price))];\n      };\n\n      return trades.length > 0 ? trades.map(renderRow) : [[[''], this.props.intl.formatMessage({\n        id: 'page.noDataToShow'\n      })]];\n    }\n  }]);\n\n  return MarketComponent;\n}(React.Component);\n\nvar mapStateToProps = function mapStateToProps(state) {\n  return {\n    recentTrades: selectRecentTradesOfCurrentMarket(state),\n    currentMarket: selectCurrentMarket(state),\n    currentPrice: selectCurrentPrice(state)\n  };\n};\n\nvar mapDispatchToProps = function mapDispatchToProps(dispatch) {\n  return {\n    tradesFetch: function tradesFetch(market) {\n      return dispatch(recentTradesFetch(market));\n    },\n    setCurrentPrice: function setCurrentPrice(payload) {\n      return dispatch(_setCurrentPrice(payload));\n    }\n  };\n};\n\nvar MarketTab = injectIntl(connect(mapStateToProps, mapDispatchToProps)(MarketComponent));\nexport { handleHighlightValue, MarketTab };","map":{"version":3,"sources":["/workspaces/temx/src/containers/RecentTrades/Market.tsx"],"names":["Decimal","Table","React","injectIntl","connect","localeDate","setTradeColor","selectCurrentMarket","selectCurrentPrice","setCurrentPrice","recentTradesFetch","selectRecentTradesOfCurrentMarket","handleHighlightValue","prevValue","curValue","highlighted","val","prev","length","slice","MarketComponent","getHeaders","props","intl","formatMessage","id","handleOnSelect","index","recentTrades","currentPrice","priceToSet","Number","price","next","currentMarket","tradesFetch","getTrades","trades","priceFixed","price_precision","amountFixed","amount_precision","renderRow","item","i","created_at","taker_type","amount","higlightedDate","String","color","map","Component","mapStateToProps","state","mapDispatchToProps","dispatch","market","payload","MarketTab"],"mappings":"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","sourcesContent":["import { Decimal, Table } from '@openware/components';\nimport * as React from 'react';\nimport {\n    InjectedIntlProps,\n    injectIntl,\n} from 'react-intl';\nimport { connect, MapDispatchToPropsFunction } from 'react-redux';\nimport { localeDate, setTradeColor } from '../../helpers';\nimport {\n    Market,\n    PublicTrade,\n    RootState,\n    selectCurrentMarket,\n    selectCurrentPrice,\n    setCurrentPrice,\n} from '../../modules';\nimport { recentTradesFetch, selectRecentTradesOfCurrentMarket } from '../../modules/public/recentTrades';\n\ninterface ReduxProps {\n    recentTrades: PublicTrade[];\n    currentMarket: Market | undefined;\n    currentPrice: number | undefined;\n}\n\ninterface DispatchProps {\n    tradesFetch: typeof recentTradesFetch;\n    setCurrentPrice: typeof setCurrentPrice;\n}\n\ntype Props = DispatchProps & ReduxProps & InjectedIntlProps;\n\nconst handleHighlightValue = (prevValue: string, curValue: string) => {\n    let highlighted = '';\n    let val = curValue;\n    let prev = prevValue;\n\n    while (val !== prev && val.length > 0) {\n        highlighted = val[val.length - 1] + highlighted;\n        val = val.slice(0, -1);\n        prev = prev.slice(0, -1);\n    }\n\n    return (\n        <React.Fragment>\n            <span className=\"cr-decimal__opacity\">{val}</span>\n            <span>{highlighted}</span>\n        </React.Fragment>\n    );\n};\n\n\nclass MarketComponent extends React.Component<Props> {\n    public componentWillReceiveProps(next: Props) {\n        if (next.currentMarket && this.props.currentMarket !== next.currentMarket) {\n            this.props.tradesFetch(next.currentMarket);\n        }\n    }\n\n    public componentDidMount() {\n        if (this.props.currentMarket) {\n            this.props.tradesFetch(this.props.currentMarket);\n        }\n    }\n\n    public render() {\n        return (\n            <div className=\"pg-recent-trades__markets\">\n                <Table\n                    data={this.getTrades(this.props.recentTrades)}\n                    header={this.getHeaders()}\n                    onSelect={this.handleOnSelect}\n                />\n            </div>\n        );\n    }\n\n    private getHeaders = () => {\n        return [\n            this.props.intl.formatMessage({ id: 'page.body.trade.header.recentTrades.content.time' }),\n            this.props.intl.formatMessage({ id: 'page.body.trade.header.recentTrades.content.amount' }),\n            this.props.intl.formatMessage({ id: 'page.body.trade.header.recentTrades.content.price' }),\n        ];\n    };\n\n    private getTrades(trades: PublicTrade[]) {\n        const priceFixed = this.props.currentMarket ? this.props.currentMarket.price_precision : 0;\n        const amountFixed = this.props.currentMarket ? this.props.currentMarket.amount_precision : 0;\n\n        const renderRow = (item, i) => {\n            const { created_at, taker_type, price, amount } = item;\n            const higlightedDate = handleHighlightValue(String(localeDate(trades[i - 1] ? trades[i - 1].created_at : '', 'time')), String(localeDate(created_at, 'time')));\n\n            return [\n                <span style={{ color: setTradeColor(taker_type).color }} key={i}>{higlightedDate}</span>,\n                <span style={{ color: setTradeColor(taker_type).color }} key={i}><Decimal fixed={amountFixed}>{amount}</Decimal></span>,\n                <span style={{ color: setTradeColor(taker_type).color }} key={i}><Decimal fixed={priceFixed} prevValue={trades[i - 1] ? trades[i - 1].price : 0}>{price}</Decimal></span>,\n            ];\n        };\n        return (trades.length > 0)\n            ? trades.map(renderRow)\n            : [[[''], this.props.intl.formatMessage({ id: 'page.noDataToShow' })]];\n    }\n\n    private handleOnSelect = (index: string) => {\n        const { recentTrades, currentPrice } = this.props;\n        const priceToSet = recentTrades[Number(index)] ? recentTrades[Number(index)].price : '';\n\n        if (currentPrice !== priceToSet) {\n            this.props.setCurrentPrice(priceToSet);\n        }\n    };\n}\n\nconst mapStateToProps = (state: RootState): ReduxProps => ({\n    recentTrades: selectRecentTradesOfCurrentMarket(state),\n    currentMarket: selectCurrentMarket(state),\n    currentPrice: selectCurrentPrice(state),\n});\n\nconst mapDispatchToProps: MapDispatchToPropsFunction<DispatchProps, {}> = dispatch => ({\n    tradesFetch: market => dispatch(recentTradesFetch(market)),\n    setCurrentPrice: payload => dispatch(setCurrentPrice(payload)),\n});\n\nconst MarketTab = injectIntl(connect(mapStateToProps, mapDispatchToProps)(MarketComponent));\n\nexport {\n    handleHighlightValue,\n    MarketTab,\n};\n"]},"metadata":{},"sourceType":"module"}